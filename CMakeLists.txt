PROJECT (Jui)
CMAKE_MINIMUM_REQUIRED( VERSION 3.8 )

# GLOBAL SETUP ###################################################

SET(CMAKE_INSTALL_PREFIX ${CMAKE_BINARY_DIR} CACHE STRING  "Cmake install path" FORCE)
SET(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS TRUE)
SET_PROPERTY(GLOBAL PROPERTY USE_FOLDERS ON)

# FUNCTIONS SETUP ###################################################

FUNCTION(QT_ADDMODULE TARGET MODULE)
	
	MESSAGE(STATUS "MODULE: " ${MODULE})
	FIND_PACKAGE(Qt5 REQUIRED COMPONENTS ${MODULE})
	
	GET_TARGET_PROPERTY(module_INCLUDE_DIRS Qt5::${MODULE} INTERFACE_INCLUDE_DIRECTORIES)
	GET_TARGET_PROPERTY(module_LIBRARIES Qt5::${MODULE} IMPORTED_IMPLIB_RELEASE)
	GET_TARGET_PROPERTY(module_LOCATION Qt5::${MODULE} IMPORTED_LOCATION_RELEASE)
		
	TARGET_INCLUDE_DIRECTORIES(${TARGET} PUBLIC ${module_INCLUDE_DIRS})
	TARGET_LINK_LIBRARIES(${TARGET} PUBLIC ${module_LIBRARIES})
	
	INSTALL(FILES ${module_LOCATION} DESTINATION bin)
	
	MESSAGE(STATUS "Qt5${MODULE}_LIBRARIES: " ${module_LIBRARIES})
	MESSAGE(STATUS "Qt5${MODULE}_LOCATION: " ${module_LOCATION})
	MESSAGE(STATUS "Qt5${MODULE}_INCLUDE_DIRS: ")
	FOREACH(onePath ${module_INCLUDE_DIRS})
	 	MESSAGE(STATUS "\t - " ${onePath})
	ENDFOREACH(onePath)

ENDFUNCTION(QT_ADDMODULE)

# SOURCES SETUP ###################################################

#LIST(JuiHeaders "")
#LIST(JuiSources "")

#ADD_SUBDIRECTORY(src)

# LIBRARY SETUP ###################################################

#FILE(GLOB libHeaders "src/*.h")
#FILE(GLOB libSources "src/*.cpp")

ADD_LIBRARY(Jui SHARED "")
QT_ADDMODULE(Jui Core)
#ADD_LIBRARY(Jui SHARED ${libHeaders} ${libSources})
#ADD_SUBDIRECTORY(src)

ADD_EXECUTABLE(Config "")


ADD_SUBDIRECTORY(src)
#INCLUDE(src/CMakeLists.txt)


SOURCE_GROUP("CmakeStructure" FILES ${CMAKE_CURRENT_LIST_FILE})


INSTALL(TARGETS Jui EXPORT JuiTargets
    ARCHIVE DESTINATION lib
    LIBRARY DESTINATION lib
	  RUNTIME DESTINATION bin
    INCLUDES DESTINATION include
)
INSTALL(FILES ${libHeaders} DESTINATION include COMPONENT Devel)

# PACKAGE SETUP ###################################################

INCLUDE(CMakePackageConfigHelpers)

CONFIGURE_PACKAGE_CONFIG_FILE(
	${CMAKE_SOURCE_DIR}/JuiConfig.cmake.in
	${CMAKE_BINARY_DIR}/JuiConfig.cmake
	INSTALL_DESTINATION lib/cmake
	#PATH_VARS ${CMAKE_BINARY_DIR@/bin}
)

EXPORT(EXPORT JuiTargets
  FILE "${CMAKE_BINARY_DIR}/JuiTargets.cmake"
)

INSTALL(
  EXPORT JuiTargets
  FILE JuiTargets.cmake
  DESTINATION lib/cmake
)

INSTALL(
  FILES "${CMAKE_CURRENT_BINARY_DIR}/JuiConfig.cmake"
  DESTINATION lib/cmake
  COMPONENT Devel
)

EXPORT ( PACKAGE Jui ) 

